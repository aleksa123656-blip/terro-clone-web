<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body { margin:0; background:#111; color:white; font-family:-apple-system; padding:10px; }
    .i { display:flex; background:#222; margin:10px; border-radius:12px; padding:10px; align-items:center; }
    .i img { width:60px; height:60px; border-radius:8px; margin-right:10px; }
    .q { display:flex; background:#333; border-radius:20px; padding:5px; margin-left:auto; }
    .q button { background:none; border:none; color:white; width:30px; }
    .t { padding:20px; font-size:18px; }
    .co { background:#007aff; color:white; padding:15px; text-align:center; border-radius:12px; margin:20px 10px; }
  </style>
</head>
<body>
  <div id="items"></div>
  <div class="t" id="total">Итого: 0 ₽</div>
  <div class="co" onclick="send()">Оформить заказ</div>

  <script>
    Telegram.WebApp.ready();
    const p = {1:{n:"Dior Sauvage 100ml",pr:8900},2:{n:"Chanel No.5 50ml",pr:12900}};
    function r() {
      const c = JSON.parse(localStorage.getItem('c')||'[]');
      const con = document.getElementById('items'); con.innerHTML='';
      let tot=0;
      c.forEach((it,i)=>{
        const sum = p[it.id].pr * it.q; tot+=sum;
        const d=document.createElement('div'); d.className='i';
        d.innerHTML=`<img src="https://i.imgur.com/${it.id==1?'abc123':'def456'}.jpg">
          <div style="flex:1"><div>${p[it.id].n}</div><div style="color:#aaa">${p[it.id].pr}₽ × ${it.q}</div></div>
          <div class="q"><button onclick="u(${i},-1)">−</button><span>${it.q}</span><button onclick="u(${i},1)">+</button></div>`;
        con.appendChild(d);
      });
      document.getElementById('total').textContent=`Итого: ${tot} ₽`;
    }
    window.u=(i,d)=>{let c=JSON.parse(localStorage.getItem('c')||'[]'); c[i].q+=d; if(c[i].q<=0)c.splice(i,1); localStorage.setItem('c',JSON.stringify(c)); r();}
    window.send=()=>{const c=JSON.parse(localStorage.getItem('c')||'[]'); const t=c.reduce((s,x)=>s+p[x.id].pr*x.q,0);
      const o={a:'order',c,t,ts:new Date().toLocaleString('ru-RU')}; Telegram.WebApp.sendData(JSON.stringify(o)); Telegram.WebApp.close();}
    r();
  </script>
</body>
</html>